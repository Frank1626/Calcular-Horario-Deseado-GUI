import requests
from charset_normalizer import detect
from io import StringIO
import pandas as pd
from datetime import datetime
import tkinter as tk
from tkinter import ttk

misMaterias = {'1433': 'ANALISIS NUMERICO',    '1322': 'CINEMATICA Y DINAMICA (2016)',    '54': 'DIBUJO  (2016)',    '1219': 'DIBUJO INDUSTRIAL',    '1325': 'ECUACIONES DIFERENCIALES (2016)',    '1569': 'ESTADISTICA',    '1447': 'ESTADISTICA APLICADA A LA ING. GEOMATICA',    '1593': 'ESTADISTICA PARA ING. ELEC. ELECTRONICA',    '1223': 'ESTATICA (2016)',    '1445': 'FUNDAMENTOS DE ESTADISTICA',    '1337': 'FUNDAMENTOS DE PROBABILIDAD Y ESTADISTICA',    '1424': 'MATEMATICAS AVANZADAS',    '1228': 'MECANICA  (2016)',    '1436': 'PROBABILIDAD',    '1128': 'REPRESENTACIONES GRAFICAS',    '1780': 'ACUSTICA Y OPTICA',    '1474': 'BIOLOGIA',    '1414': 'ELECTRICIDAD Y MAGNETISMO',    '1446': 'ELECTROMAGNETISMO Y OPTICA',    '1328': 'FISICA  (2016)',    '2949': 'FISICA CUANTICA',    '2211': 'FISICA EXPERIMENTAL (2016)',    '1335': 'FISICOQUIMICA PARA ING. AMBIENTAL',    '1130': 'FUNDAMENTOS DE FISICA',    '1451': 'FUNDAMENTOS DE OPTICA',    '1330': 'FUNDAMENTOS DE TERMODINAMICA Y ELECTROMAGNETISMO',    '1452': 'INTRODUCCION A  LA FISICA DEL ESTADO SOLIDO',    '6123': 'LAB. DE QUIMICA (2016)',    '6125': 'LAB. DE QUIMICA DE C. DE LA TIERRA (2016)',    '6330': 'LAB FUNDAM TERMODI ELECTROM',    '6414': 'LABORATORIO DE ELECTRICIDAD Y MAGNETISMO',    '6475': 'LABORATORIO DE QUIMICA ORGANICA',    '6231': 'LAB. QUIMICA INORGANICA',    '6450': 'LAB SISTEMAS QUIMICOS EN ING',    '6437': 'LAB TERMODINAMICA',    '1123': 'QUIMICA (2016)',    '1125': 'QUIMICA DE CIENCIAS DE LA TIERRA (2016)',    '1231': 'QUIMICA INORGANICA',    '1475': 'QUIMICA ORGANICA',    '1450': 'SISTEMAS QUIMICOS EN INGENIERIA',    '1333': 'SISTEMAS TERMODINAMICOS - ELECTROMAGNETISMO',    '1437': 'TERMODINAMICA',    '1120': 'ALGEBRA (2016)',    '1220': 'ALGEBRA LINEAL (2016)',    '1221': 'CALCULO INTEGRAL (2016)',    '1321': 'CALCULO VECTORIAL (2016)',    '1121': 'CALCULO Y GEOMETRIA ANALITICA (2016)',    '1789': 'CIENCIA TECNOLOGIA Y SOCIEDAD',    '1222': 'CULTURA Y COMUNICACION (2016)',    '1052': 'ETICA PROFESIONAL',    '8000': 'IGUALDAD DE GENERO EN INGENIERIA',    '1413': 'INTRODUCCION A LA ECONOMIA',    '1790': 'INTRODUCCION AL ANALISIS ECONOMICO EMPRESARIAL',    '1055': 'LITERATURA HISPANOAMERICANA CONTEMPORANEA',    '2080': 'RECURSOS Y NECESIDADES DE MEXICO',    '1124': 'REDACCION Y EXPOSICION DE TEMAS DE ING.(2016)',    '1794': 'SEMINARIO SOCIO-HUM.: INGENIERIA SUSTENTABLE',    '1793': 'SEMINARIO SOCIO-HUM.:INGENIERIA Y POLITICAS PUBLICAS',    '1795': 'TALLER SOCIOHUMANISTICO:CREATIVIDAD',    '1796': 'TALLER SOCIOHUMANISTICO: LIDERAZGO',    '1592': 'ANALISIS DE CIRCUITOS ELECTRICOS',    '1443': 'ANALISIS DE SISTEMAS Y SEÑALES',    '422': 'AUTOMATIZACION',    '1562': 'CIRCUITOS ELECTRICOS',    '2910': 'CONTROLADORES INDUSTRIALES PROGRAMABLES',    '678': 'CONTROL AUTOMATICO INDUSTRIAL',    '2909': 'CONTROL AVANZADO',    '1093': 'CONTROL DE SISTEMAS NO LINEALES',    '1095': 'CONTROL DISTRIBUIDO E INTEGRACION SCADA',    '129': 'DINAMICA DE SISTEMAS FISICOS',    '1460': 'ELEMENTOS DE CONTROL',    '2905': 'FISIOLOGIA DEL SISTEMA ENDOCRINO Y NERVIOSO',    '1997': 'FUNDAMENTOS DE CONTROL',    '692': 'FUNDAMENTOS DE INSTRUMENTACION BIOMEDICA',    '2906': 'INGENIERIA CLINICA',    '693': 'INSTRUMENTACION VIRTUAL',    '6592': 'LAB. ANALISIS DE CIRCUITOS ELECTRICOS',    '6443': 'LAB. ANALISIS DE  SISTEMAS Y SEÑALES',    '5422': 'LAB. AUTOMATIZACION',    '6562': 'LAB. CIRCUITOS ELECTRICOS',    '7910': 'LAB CONTROLADORES INDUSTRIALES PROGRAMABLES',    '5678': 'LAB. CONTROL AUTOMATICO INDUSTRIAL',    '7909': 'LAB. CONTROL AVANZADO',    '6093': 'LAB. CONTROL DE SISTEMAS NO LINEALES',    '6095': 'LAB. CONTROL DISTRIBUIDO E INTEGRACION SCADA',    '6997': 'LAB. FUNDAMENTOS DE CONTROL',    '5692': 'LAB. FUNDAMENTOS DE INSTRUMENTACION BIOMEDICA',    '5693': 'LAB. INSTRUMENTACION VIRTUAL',    '5558': 'LAB. MEDICION E INSTRUMENTACION',    '7905': 'LABORATORIO FISIOLOGIA DEL SISTEMA ENDOCRINO Y NERVIOSO',    '7911': 'LAB. ROBOTICA INDUSTRIAL',    '6473': 'LAB. SEÑALES Y SISTEMAS',    '7902': 'LAB. SISTEMAS EMBEBIDOS EN INSTRUMENTACION Y CONTROL',    '6463': 'LAB. TEORIA DE CIRCUITOS',    '558': 'MEDICION E INSTRUMENTACION',    '2911': 'ROBOTICA INDUSTRIAL',    '1473': 'SEÑALES Y SISTEMAS',    '2902': 'SISTEMAS EMBEBIDOS EN INSTRUMENTACION Y CONTROL',    '955': 'SISTEMAS Y EQUIPOS BIOMEDICOS ELECTRONICOS',    '1454': 'SISTEMAS Y SEÑALES',    '2903': 'TEMAS SELECTOS DE CONTROL Y ROBOTICA',    '3007': 'TEMAS SELECTOS DE INGENIERIA BIOMEDICA',    '1463': 'TEORIA DE CIRCUITOS',    '1723': 'AMPLIFICADORES ELECTRONICOS',    '428': 'AMPLIFICADORES PARA MICROONDAS',    '700': 'BIOMEMS Y DISPOSITIVOS "LAB ON A CHIP"',    '1822': 'CIRCUITOS INTEGRADOS ANALOGICOS',    '425': 'CIRCUITOS PARA COMUNICACIONES',    '1617': 'DISEÑO DIGITAL',    '138': 'DISPOSITIVOS ELECTRONICOS',    '426': 'DISPOSITIVOS ELECTRONICOS PROGRAMABLES',    '1618': 'DISPOSITIVOS Y CIRCUITOS ELECTRONICOS',    '145': 'ELECTRONICA DE POTENCIA',    '1594': 'FISICA DE SEMICONDUCTORES',    '427': 'INTRODUCCION A LA TECNOLOGIA MEMS',    '6723': 'LAB.  AMPLIFICADORES ELECTRONICOS',    '6822': 'LAB. CIRCUITOS INTEGRADOS ANALOGICOS',    '5425': 'LAB. CIRCUITOS PARA COMUNICACIONES',    '6617': 'LAB. DISEÑO DIGITAL',    '5138': 'LAB. DISPOSITIVOS ELECTRONICOS',    '6618': 'LAB. DISPOSITIVOS Y CIRCUITOS ELECTRONICOS',    '6937': 'LAB. MICROPROCESADORES Y MICROCONTROLADORES',    '6453': 'LAB. SISTEMAS DIGITALES',    '8002': 'LAB. SISTEMAS ELECTRONICOS',    '767': 'MEMS PARA RADIOFRECUENCIA',    '1937': 'MICROPROCESADORES Y MICROCONTROLADORES',    '768': 'PROCESADORES MULTINUCLEO',    '2309': 'REDES EMBEBIDAS INALAMBRICAS',    '918': 'SISTEMAS DIFUSOS',    '1453': 'SISTEMAS DIGITALES',    '3002': 'SISTEMAS ELECTRONICOS',    '1010': 'SISTEMAS EMBEBIDOS',    '3003': 'SISTEMAS OPERATIVOS EN TIEMPO REAL',    '2006': 'TEMAS SELECTOS DE ELECTRONICA',    '2944': 'ADMINISTRACION DE CENTROS DE TECNOLOGIA DE INFORMACION',    '1643': 'ADMINISTRACION DE PROYECTOS DE SOFTWARE',    '2928': 'ADMINISTRACION DE PROYECTOS TIC',    '1866': 'ADMINISTRACION DE REDES',    '2945': 'ADMINISTRACION DE SERVICIOS DE INTERNET',    '2932': 'ANALISIS Y PROCESAMIENTO INTELIGENTE DE TEXTOS',    '2946': 'ARQUITECTURA CLIENTE SERVIDOR',    '1644': 'BASES DE DATOS',    '2929': 'BASES DE DATOS AVANZADAS',    '2947': 'BASES DE DATOS DISTRIBUIDAS',    '434': 'COMPILADORES',    '2948': 'COMPUTACION GRAFICA AVANZADA',    '1590': 'COMPUTACION GRAFICA E INTERACCION HUMANO-COMPUTADORA',    '674': 'COMPUTO MOVIL',    '2930': 'CRIPTOGRAFIA',    '1645': 'DISEÑO DIGITAL MODERNO',    '1535': 'DISEÑO DIGITAL VLSI',    '1765': 'DISPOSITIVOS DE ALMACENAMIENTO Y ENTRADA-SALIDA',    '1227': 'ESTRUCTURA DE DATOS Y ALGORITMOS I',    '1317': 'ESTRUCTURA DE DATOS Y ALGORITMOS II',    '119': 'ESTRUCTURAS DISCRETAS',    '1503': 'ESTRUCTURA Y PROGRAMACION  DE COMPUTADORAS',    '1537': 'FINANZAS EN LA INGENIERIA EN COMPUTACION',    '1122': 'FUNDAMENTOS DE PROGRAMACION (2016)',    '1858': 'FUNDAMENTOS DE SISTEMAS EMBEBIDOS',    '1531': 'INGENIERIA DE SOFTWARE',    '406': 'INTELIGENCIA ARTIFICIAL',    '6866': 'LAB. ADMINISTRACION DE REDES',    '6644': 'LAB. BASES DE DATOS',    '6590': 'LAB. COMPUTACION GRAFICA E INTERACCION HUMANO-COMPUTADORA',    '6645': 'LAB. DISEÑO DIGITAL MODERNO',    '6765': 'LAB. DISPOSITIVOS DE ALMACENAMIENTO E/S',    '6672': 'LAB. MICROCOMPUTADORAS',    '6867': 'LAB. ORGANIZACION Y ARQUITECTURA DE COMPUTADORAS',    '6598': 'LAB. REDES DE DATOS SEGURAS',    '442': 'LENGUAJES FORMALES Y AUTOMATAS',    '1672': 'MICROCOMPUTADORAS',    '2933': 'MINERIA DE DATOS',    '1332': 'MODELOS DE PROGRAMACION ORIENTADA A OBJETOS',    '2931': 'NEGOCIOS ELECTRONICOS Y DESARROLLO WEB',    '1867': 'ORGANIZACION Y ARQUITECTURA DE COMPUTADORAS',    '2950': 'PROCESAMIENTO DEL LENGUAJE NATURAL',    '1127': 'PROGRAMACION BASICA',    '1323': 'PROGRAMACION ORIENTADA A OBJETOS',    '1598': 'REDES DE DATOS SEGURAS',    '2953': 'ROBOTS MOVILES',    '2954': 'SEGURIDAD INFORMATICA AVANZADA',    '2934': 'SEGURIDAD INFORMATICA BASICA',    '2955': 'SEMINARIO DE TITULACION PARA INGENIEROS EN COMPUTACION',    '1959': 'SISTEMAS DISTRIBUIDOS',    '840': 'SISTEMAS OPERATIVOS',    '2956': 'TEMAS SELECTOS DE INGENIERIA EN COMPUTACION I',    '2957': 'TEMAS SELECTOS DE INGENIERIA EN COMPUTACION II',    '2958': 'TEMAS SELECTOS DE INGENIERIA EN COMPUTACION III',    '423': 'INSTALACIONES ELECTRICAS',    '6998': 'LAB. MAQUINAS ELECTRICAS I',    '7900': 'LAB. MAQUINAS ELECTRICAS II',    '5636': 'LAB. PROTECCION DE SISTEMAS ELECTRICOS',    '6936': 'LAB. SISTEMAS ELECTRICOS DE POTENCIA I',    '7908': 'LAB. SISTEMAS ELECTRICOS DE POTENCIA II',    '1998': 'MAQUINAS ELECTRICAS I',    '2900': 'MAQUINAS ELECTRICAS II',    '2907': 'MAQUINAS ELECTRICAS III L',    '627': 'PLANTAS GENERADORAS',    '636': 'PROTECCION DE SISTEMAS ELECTRICOS',    '2003': 'SISTEMAS DE DISTRIBUCION',    '2004': 'SISTEMAS DE TRANSPORTE ELECTRICO',    '1936': 'SISTEMAS ELECTRICOS DE POTENCIA I',    '2908': 'SISTEMAS ELECTRICOS DE POTENCIA II',    '1016': 'SUBESTACIONES ELECTRICAS',    '5754': 'LAB. PROCESAMIENTO DIGITAL DE IMÁGENES MEDICAS',    '1916': 'PROCESAMIENTO DIGITAL DE IMAGENES',    '754': 'PROCESAMIENTO DIGITAL DE IMAGENES MEDICAS: Imagenologia',    '2901': 'PROCESAMIENTO DIGITAL DE SEÑALES',    '757': 'RECONOCIMIENTO DE PATRONES',    '1624': 'ENERGIA E IMPACTO AMBIENTAL',    '3008': 'ENERGIAS RENOVABLES',    '3009': 'FUNDAMENTOS DE INGENIERIA NUCLEAR',    '3012': 'INTRODUCCION A LA CONVERSION DE ENERGIA',    '3014': 'INTRODUCCION AL AHORRO Y A LA GESTION ENERGETICA',    '2912': 'INTRODUCCION A LOS SISTEMAS ENERGETICOS',    '3016': 'PLANEACION DE SISTEMAS DE GENERACION ELECTRICA',    '3017': 'PLANEACION E INSTALACION DE SISTEMAS DE BIOENERGIA',    '2009': 'TEMAS SELECTOS DE SISTEMAS ENERGETICOS',    '3023': 'USO EFICIENTE EN EQUIPOS DE SERVICIO',    '1773': 'ANTENAS',    '1458': 'CAMPOS Y ONDAS',    '1467': 'CIRCUITOS DE RADIOFRECUENCIA',    '2311': 'CODIFICACION MULTIMEDIA',    '109': 'COMUNICACIONES DIGITALES',    '1774': 'DISPOSITIVOS DE MICROONDAS I',    '1874': 'DISPOSITIVOS  DE MICROONDAS II',    '1459': 'DISPOSITIVOS DE RADIOFRECUENCIA',    '1461': 'FUNDAMENTOS DE PROCESOS ALEATORIOS',    '1462': 'FUNDAMENTOS DE SISTEMAS DE COMUNICACIONES',    '1469': 'FUNDAMENTOS Y APLICACIONES PARA EL PROCESAMIENTO DIGITAL DE SEÑALES',    '2302': 'INNOVACION TECNOLOGICA Y PROSPECTIVA DE LAS TELECOMUNICACIONES',    '1470': 'INTRODUCCION A LA CODIFICACION DE FUENTE Y CANAL',    '6773': 'LAB. ANTENAS',    '6467': 'LAB. CIRCUITOS DE RADIOFRECUENCIA',    '5109': 'LAB. COMUNICACIONES DIGITALES',    '6774': 'LAB. DISPOSITIVOS DE MICROONDAS I',    '6874': 'LAB. DISPOSITIVOS DE MICROONDAS II',    '6459': 'LAB. DISPOSITIVOS DE RADIOFRECUENCIA',    '6462': 'LAB. FUNDAMENTOS DE SISTEMAS DE COMUNICACIONES',    '6682': 'LAB. MEDIOS DE TRANSMISION',    '7704': 'LAB. PROCESAMIENTO DE SEÑALES DIGITALES EN  TIEMPO REAL',    '6686': 'LAB. SISTEMAS DE COMUNICACIONES',    '6999': 'LAB. SISTEMAS DE COMUNICACIONES ELECTRONICAS',    '6875': 'LAB. SISTEMAS DE COMUNICACIONES OPTICAS',    '5879': 'LAB. TEORIA ELECTROMAGNETICA',    '7706': 'LAB. TRANSMISORES Y RECEPTORES',    '1682': 'MEDIOS DE TRANSMISION',    '1138': 'PRINCIPIOS PRACTICOS DE ELECTRONICA',    '2704': 'PROCESAMIENTO DE SEÑALES DIGITALES EN  TIEMPO REAL',    '2705': 'REDES DE TELECOMUNICACIONES',    '1974': 'REDES INALAMBRICAS Y MOVILES',    '2962': 'REGULACION DE LAS TELECOMUNICACIONES',    '1686': 'SISTEMAS DE COMUNICACIONES',    '1999': 'SISTEMAS DE COMUNICACIONES ELECTRONICAS',    '1875': 'SISTEMAS DE COMUNICACIONES OPTICAS',    '2813': 'SISTEMAS DE RADIOCOMUNICACIONES I',    '2963': 'SISTEMAS DE RADIOCOMUNICACIONES II',    '2814': 'TECNOLOGIAS E INTERCONEXION DE REDES',    '2308': 'TECNOLOGIAS PARA LA SOCIEDAD DE LA INFORMACION',    '2305': 'TEMAS SELECTOS DE NORMALIZACION Y DESARROLLO INDUSTRIAL',    '2306': 'TEMAS SELECTOS DE TELECOMUNICACIONES',    '879': 'TEORIA ELECTROMAGNETICA',    '2706': 'TRANSMISORES Y RECEPTORES',    '2807': 'ADMINISTRACION APLICADA A LA MINERIA',    '1455': 'ANALISIS QUIMICO',    '2959': 'ANALISIS Y EVALUACION DE PROYECTOS DE INVERSION',    '3092': 'DEPOSITOS DE RESIDUOS MINEROS',    '2960': 'DISEÑO DE OPERACIONES METALURGIAS',    '2965': 'DISEÑO DE OPERACIONES MINERAS',    '2808': 'EXPLOTACION DE MINAS A CIELO ABIERTO',    '2701': 'EXPLOTACION DE MINAS SUBTERRANEAS',    '1625': 'FISICOQUIMICA',    '1464': 'FUNDAMENTOS DE METALURGIA EXTRACTIVA',    '1465': 'FUNDAMENTOS PARA LA EXPLOTACION DE MINAS',    '2809': 'GESTION AMBIENTAL EN MINERIA',    '2964': 'GESTION DE SEGURIDAD E HIGIENE',    '2810': 'HIDRO Y PIROMETALURGIA',    '1939': 'INSTALACIONES MINERO METALURGICAS',    '1131': 'INTRODUCCION A LA INGENIERIA DE MINAS Y METALURGIA',    '2961': 'INTRODUCCION AL DISEÑO DE OPERACIONES MINERAS',    '1456': 'LEGISLACION MINERA',    '2702': 'MECANICA APLICADA Y PROCEDIMIENTOS DE CONSTRUCCION',    '1457': 'METODOS DE MEDICION  MINERO-CARTOGRAFICOS',    '3094': 'MINERALES NO METALICOS',    '3095': 'MOLIENDA FINA Y ULTRAFINA',    '2703': 'PREPARACION Y CONCENTRACION  DE MINERALES',    '948': 'TEMAS SELECTOS',    '914': 'VENTILACION',    '3097': 'VOLADURA DE ROCAS',    '1143': 'ANALISIS DE REGISTROS SISMICOS',    '2605': 'ANALISIS ESPECTRAL DE SEÑALES',    '2606': 'FISICA DE LAS ONDAS',    '1028': 'FUENTE SISMICA',    '2607': 'FUNDAMENTOS DE TEORIA ELECTROMAGNETICA',    '2968': 'GEOFISICA INTEGRAL',    '1468': 'INTRODUCCION A LA GEOFISICA',    '2707': 'INTRODUCCION AL DISEÑO DE FILTROS DIGITALES',    '2815': 'INTRODUCCION AL TRATAMIENTO SEÑALES',    '2966': 'INVERSION DE DATOS GEOFISICOS',    '531': 'MECANICA DEL MEDIO CONTINUO',    '1026': 'PERCEPCION REMOTA APLICADA',    '2094': 'PETROFISICA Y REGISTROS GEOFISICOS EN POZOS',    '2969': 'PROCESAMIENTO DE DATOS GEOFISICOS',    '2816': 'PROSPECCION ELECTRICA',    '2967': 'PROSPECCION ELECTROMAGNETICA',    '1577': 'PROSPECCION GEOFISICA DE REGISTROS DE POZOS',    '2708': 'PROSPECCION GRAVIMETRICA Y MAGNETOMETRICA',    '2709': 'PROSPECCION SISMICA I',    '2817': 'PROSPECCION SISMICA II',    '1591': 'REGISTROS GEOFISICOS EN POZO',    '1032': 'SISMOLOGIA APLICADA A LA GEOTECNIA',    '1030': 'SISMOLOGIA DE MOVIMIENTOS FUERTES',    '1141': 'TEMAS SEL. DE ING GEOFISICA I',    '1142': 'TEMAS SEL. DE ING GEOFISICA II',    '2503': 'TEORIA DEL POTENCIAL APLICADA A LA GEOFISICA',    '2504': 'VARIABLE COMPLEJA APLICADA A LA GEOFISICA',    '1061': 'GEOLOGIA APLICADA A LA INGENIERIA CIVIL',    '1575': 'GEOLOGIA DE CAMPO Y CARTOGRAFIA',    '1587': 'GEOLOGIA DE MEXICO',    '1572': 'GEOLOGIA ESTRUCTURAL',    '1327': 'GEOLOGIA FISICA',    '424': 'GEOLOGIA GENERAL  (2016)',    '2085': 'GEOLOGIA URBANA',    '1067': 'GEOMETRIA DESCRIPTIVA APLICADA',    '1576': 'GEOMORFOLOGIA',    '1583': 'MECANICA DE ROCAS',    '2090': 'MECANICA DE SUELOS PARA CIENCIAS DE LA TIERRA',    '1586': 'PROYECTOS DE INGENIERIA GEOLOGICA',    '2095': 'RIESGO GEOLOGICO',    '1578': 'SISTEMAS DE INFORMACION GEOGRAFICA',    '1438': 'TECNICAS GEOLOGICAS DE CAMPO',    '2096': 'TEMAS SELECTOS DE INGENIERIA GEOLOGICA I',    '2098': 'TEMAS SELECTOS DE INGENIERIA GEOLOGICA III',    '1861': 'ADMINISTRACION DE LA SEGURIDAD INDUSTRIAL  Y PROTECCION AMBIENTAL',    '1961': 'ADMINISTRACION INTEGRAL DE YACIMIENTOS',    '1990': 'ADMINISTRACION INTEGRAL DE YACIMIENTOS',    '956': 'ASEGURAMIENTO DE FLUJO',    '1588': 'BOMBEO Y COMPRESION DE HIDROCARBUROS',    '1984': 'CARACTERIZACION DINAMICA DE YACIMIENTOS',    '1661': 'CARACTERIZACION ESTATICA DE YACIMIENTOS',    '1980': 'CARACTERIZACION ESTATICA DE YACIMIENTOS',    '960': 'CARACTERIZACION ESTATICA Y DINAMICA DE YACIMIENTOS NATURALMENTE FRACTU',    '970': 'COMERCIALIZACION DE CRUDO Y GAS NATURAL',    '1073': 'COMERCIALlZACION DE CRUDO Y GAS NATURAL',    '1981': 'COMPORTAMIENTO DE YACIMIENTOS',    '1991': 'CONDUCCION Y MANEJO DE PRODUCCION DE HIDROCARBUROS',    '1962': 'CONDUCCON Y MANEJO DE LA PRODUCCION DE HIDROCARBUROS',    '1992': 'ECONOMIA DE LOS HIDROCARBUROS',    '2081': 'EQUIPO Y HERRAMIENTAS DE PERFORACION DE POZOS',    '1439': 'FLUIDOS DE PERFORACION',    '1663': 'FLUJO MULTIFASICO EN TUBERIA',    '1982': 'FLUJO MULTIFASICO EN TUBERIAS',    '977': 'FRACTURAMIENTO HIDRAULICO',    '1080': 'FRACTURAMIENTO HIDRAULICO',    '1068': 'INGENIERIA DE PERFORACION DE POZOS',    '1963': 'INGENIERIA DE YACIMIENTOS DE GAS',    '1988': 'INGENIERIA DE YACIMIENTOS DE GAS',    '1126': 'INTRODUCCION A LA INGENIERIA PETROLERA (2016)',    '1993': 'LEGISLACION DE LA INDUSTRIA PETROLERA',    '1441': 'MECANICA DE FLUIDOS',    '979': 'METODOS GEOFISICOS PARA PETROLEROS',    '978': 'METROLOGIA APLICADA A LA MEDICION DE CAUDAL O VOLUMEN DE HIDROCARBUROS',    '1071': 'PERFORACION DE POZOS EN AGUAS PROFUNDAS',    '2011': 'PERFORACION DE POZOS EN AGUAS PROFUNDAS',    '1985': 'PERFORACION NO CONVENCIONAL',    '1994': 'PLANEACION Y EVALUACION DE PROYECTOS PETROLEROS',    '1589': 'PRINCIPIOS DE MECANICA DE YACIMIENTOS',    '1665': 'PRODUCTIVIDAD DE POZOS',    '1983': 'PRODUCTIVIDAD DE POZOS',    '1666': 'PROGRAMACION AVANZADA',    '1442': 'PROPIEDADES DE LOS FUIDOS PETROLEROS',    '1995': 'PROYECTOS INTEGRALES PETROLEROS',    '1863': 'RECUPERACION SECUNDARIA Y MEJORADA',    '1986': 'RECUPERACION SECUNDARIA Y MEJORADA',    '2013': 'REGISTROS EN POZO ENTUBADO',    '1090': 'SIMULACION MATEMATICA DE YACIMIENTOS',    '2067': 'SIMULACION NUMERICA DE YACIMIENTOS NATURALMENTE FRACTURADOS',    '1944': 'SISTEMAS ARTIFICIALES DE PRODUCCION',    '1987': 'SISTEMAS ARTIFICIALES DE PRODUCCION',    '1116': 'TEMAS SELECTOS DE INGENIERIA PETROLERA',    '1965': 'TEMAS SELECTOS INGENIERIA PETROLERA',    '1864': 'TERMINACION Y MANTENIMIENTO DE POZOS',    '1989': 'TERMINACION Y MANTENIMIENTO DE POZOS',    '2069': 'YACIMIENTOS DE GAS DE BAJA PERMEABILIDAD',    '1584': 'GEOESTADISTICA',    '1871': 'GEOLOGIA APLICADA A LA MINERIA',    '1573': 'GEOQUIMICA',    '2088': 'GEOTECNIA DE EXCAVACION',    '1850': 'METALOGENIA',    '487': 'MINERALOGIA',    '1574': 'MINERALOGIA OPTICA',    '1137': 'PETROLOGIA',    '1690': 'PETROLOGIA IGNEA',    '1677': 'PETROLOGIA METAMORFICA',    '1729': 'PETROLOGIA SEDIMENTARIA',    '1466': 'PROSPECCION Y EXPLORACION MINERA',    '2099': 'YACIMIENTOS MINERALES TECNICAS ANALITICAS',    '1727': 'ESTRATIGRAFIA',    '2082': 'EXPLORACION GEOTERMICA',    '1580': 'GEOLOGIA AMBIENTAL',    '1582': 'GEOLOGIA DEL SUBSUELO',    '1066': 'GEOLOGIA DE PETROLEO',    '1331': 'GEOLOGIA DE YACIMIENTOS DE FLUIDOS',    '1585': 'GEOLOGIA HISTORICA',    '2084': 'GEOLOGIA MARINA',    '1440': 'GEOLOGIA Y GEOQUIMICA DEL PETROLEO',    '2089': 'HIDROGEOLOGIA DE CONTAMINANTES',    '1088': 'HIDROGEOLOGIA  (se ofrece para geólogos y geofísicos)',    '2092': 'MODELACION NUMERICA Y COMPUTACIONAL DE ACUIFEROS',    '2093': 'PALEONTOLOGIA ESTRATIGRAFICA',    '1329': 'PALEONTOLOGIA GENERAL',    '824': 'SEDIMENTOLOGIA',    '1579': 'TECTONICA',    '2922': 'ANALISIS POR ELEMENTOS FINITOS',    '997': 'DETERIORO DE MATERIALES',    '1209': 'DIBUJO MECANICO E INDUSTRIAL',    '2806': 'DINAMICA DE MAQUINARIA',    '1782': 'DISEÑO DE ELEMENTOS DE MAQUINAS',    '126': 'DISEÑO DE HERRAMENTAL',    '971': 'DISEÑO DEL PRODUCTO',    '3078': 'DISEÑO SUSTENTABLE',    '972': 'DISEÑO Y MANUFACTURA ASISTIDA POR COMPUTADORA',    '2923': 'INGENIERIA ASISTIDA POR COMPUTADORA',    '3071': 'INGENIERIA  AUTOMOTRIZ I',    '992': 'INGENIERIA DE DISEÑO',    '507': 'INGENIERIA DE MANUFACTURA',    '1570': 'INGENIERIA DE MATERIALES',    '2212': 'INTRODUCCION A LA INGENIERIA MECANICA',    '6225': 'LAB. DE MANUFACTURA  I (2016)',    '5992': 'LAB. INGENIERIA DE DISEÑO',    '6570': 'LAB INGENIERIA DE MATERIALES',    '7924': 'LAB. MANUFACTURA III',    '7500': 'LAB MATERIALES II',    '7925': 'LAB. MATERIALES III',    '7806': 'LABORATORIO DE DINAMICA DE MAQUINARIA',    '5507': 'LABORATORIO DE INGENIERIA DE MANUFACTURA',    '7603': 'LABORATORIO DE MANUFACTURA II',    '1225': 'MANUFACTURA I (2016)',    '2603': 'MANUFACTURA  II',    '2924': 'MANUFACTURA III',    '2500': 'MATERIALES II',    '2925': 'MATERIALES III',    '1540': 'MECANICA DE SOLIDOS',    '1659': 'MECANISMOS',    '3064': 'SISTEMAS DE MANUFAC FLEXIBLE',    '3083': 'TEMAS SELECTOS DE INGENIERIA DE DISEÑO I',    '3084': 'TEMAS SELECTOS DE INGENIERIA DE DISEÑO II',    '3087': 'TEMAS SELECTOS DE INGENIERIA MATERIALES Y MANUFACTURA I',    '12': 'ADMINISTRACION',    '18': 'ADMINISTRACION',    '2919': 'ANALISIS Y MEJORA DE PROCESOS',    '946': 'CALIDAD',    '2103': 'CALIDAD',    '3073': 'COMERCIO INTERNACIONAL',    '2602': 'CONTABILIDAD FINANCIERA Y DE COSTOS',    '944': 'COSTOS Y EVALUACION DE PROYECTOS',    '3065': 'COSTOS Y LOGISTICA DE SISTEMAS DE TRANSPORTE',    '3020': 'CREATIVIDAD E INOVACION',    '1057': 'DESARROLLO DE HABILIDADES DIRECTIVAS',    '947': 'DESARROLLO EMPRESARIAL',    '1059': 'DESARROLLO EMPRESARIAL',    '2920': 'DIRECCION DE PROYECTOS',    '2804': 'DISEÑO DE LA CADENA DE SUMINISTROS',    '143': 'DISEÑO DE SISTEMAS PRODUCTIVOS',    '984': 'ENVASE Y EMBALAJE',    '1060': 'ENVASE Y EMBALAJE',    '3070': 'ERGONOMIA EN EL TRABAJO',    '1784': 'ESTADISTICA APLICADA',    '192': 'ESTUDIO DEL TRABAJO',    '1955': 'EVALUACION DE PROYECTOS DE INVERSION',    '3076': 'FINANZAS COORPORATIVAS',    '1539': 'INGENIERIA ECONOMICA',    '1734': 'INGENIERIA ECONOMICA',    '1129': 'INGENIERIA INDUSTRIAL Y PRODUCTIVIDAD',    '2805': 'INSTALACIONES INDUSTRIALES',    '3066': 'INTELIGENCIA DE NEGOCIOS',    '339': 'INVESTIGACION DE OPERACIONES I',    '1747': 'INVESTIGACION DE OPERACIONES II',    '985': 'LEGISLACION INDUSTRIAL',    '1074': 'LEGISLACION INDUSTRIAL',    '1058': 'LlDERAZGO Y DIRECCION DE EMPRESAS',    '3067': 'LOGISTICA INVERSA',    '3072': 'MANUFACTURA LEAN (ESBELTA)',    '3021': 'METODOLOGIA PARA LA PLANEACION',    '952': 'OPTIMIZACION DE OPERACIONES',    '619': 'PLANEACION Y CONTROL DE LA PRODUCCION',    '2917': 'PRACTICAS PROFESIONALES PARA INGENIERIA INDUSTRIAL',    '1918': 'PROCESOS INDUSTRIALES',    '1943': 'PROCESOS INDUSTRIALES',    '1745': 'RELACIONES LABORALES Y ORGANIZACIONALES',    '3022': 'RELACION LABORAL Y ORGANIZA',    '818': 'SEGURIDAD INDUSTRIAL',    '1087': 'SEGURIDAD INDUSTRIAL',    '2921': 'SIMULACION',    '1853': 'SISTEMAS DE CALIDAD',    '989': 'SISTEMAS DE COMERCIALIZACION',    '1115': 'SISTEMAS DE COMERCIALIZACION',    '3077': 'TEMAS SELECTOS DE DIRECCION Y CREACION DE EMPRESAS',    '3068': 'TEMAS SELECTOS DE GESTION DE CADENA DE SUMINSTROS',    '990': 'TEMAS SELECTOS DE LOGISTICA Y SISTEMAS',    '1550': 'ANALISIS DE CIRCUITOS',    '1198': 'AUTOMATIZACION AVANZADA',    '572': 'AUTOMATIZACION INDUSTRIAL',    '1996': 'CIRCUITOS DIGITALES',    '551': 'CONTROL AUTOMATICO',    '563': 'DISEÑO MECATRONICO',    '1691': 'ELECTRONICA BASICA',    '510': 'INSTRUMENTACION',    '1807': 'INSTRUMENTACION Y CONTROL',    '549': 'MAQUINAS ELECTRICAS',    '508': 'MODELADO DE SISTEMAS FISICOS',    '2135': 'ROBOTICA',    '3074': 'SISTEMAS DE PRODUCCION AVANZADOS',    '1973': 'SISTEMAS ELECTRONICOS LINEALES',    '1472': 'TECNICAS DE PROGRAMACION',    '3098': 'TEMAS SEL DE PROGRAMACION II',    '3089': 'TEMAS SELECTOS DE MECATRONICA I',    '3090': 'TEMAS SELECTOS DE MECATRONICA II',    '1964': 'TEMAS SELECTOS DE PROGRAMACION I',    '1787': 'AMPLIFICACION Y FILTRADO DE SEÑALES MEDICAS',    '1695': 'ANALISIS DE BIOSEÑALES',    '1895': 'ASPECTOS LEGALES Y ORGANZACIONALES ATENCION MEDICA',    '1434': 'BIOLOGIA CELULAR Y TISULAR',    '2079': 'BIOMATERIALES',    '1009': 'BIOMECANICA',    '1320': 'BIOQUIMICA (2016)',    '1781': 'BIOTERMOFLUIDOS I',    '1783': 'ERGONOMIA',    '1976': 'ESTANCIA',    '1896': 'INSTALACIONES HOSPITALARIAS',    '1571': 'INTRODUCCION A LA  ANATOMIA Y FISIOLOGIA I',    '1693': 'INTRODUCCION A LA ANATOMIA Y FISIOLOGIA II',    '1778': 'MECANICA DEL CUERPO HUMANO',    '1698': 'MEDICIONES CLINICAS',    '1786': 'PLANEACION Y CONTROL DE RECURSOS HOSPITALARIOS',    '1779': 'PSICOLOGIA MEDICA',    '1699': 'SISTEMAS DE MEDICION TRANSDUCTORES MEDICOS',    '1978': 'TEM SELEC AREA MEDICO BIOLOGICAS',    '1797': 'TEM SELEC ING SIST BIOMEDICOS I',    '1798': 'TEM SELEC ING SIST BIOMEDICOS II',    '1799': 'TEM SELEC ING SISTBIOMEDICOS III',    '1897': 'TEM SELEC ING SIST BIOMEDICOS IV',    '1898': 'TEM SELEC ING SIST BIOMEDICOS V',    '1899': 'TEM SELEC ING SIST BIOMEDICOS VI',    '1977': 'TEM SELEC ING SISTBIOMEDICOS VII',    '2802': 'AHORRO DE ENERGIA',    '21': 'AIRE ACONDICIONADO Y REFRIGERACION',    '2074': 'DISEÑO DE SISTEMAS TERMICOS',    '1521': 'ELEMENTOS DE MECANICA DEL MEDIO CONTINUO',    '354': 'INGENIERIA DE PROCESOS INDUSTRIALES',    '5462': 'LAB. MECANICA DE FLUIDOS I',    '6756': 'LAB. MECANICA DE FLUIDOS II',    '5021': 'LABORATORIO DE  AIRE ACONDICONADO Y REFRIGERACION',    '6409': 'LABORATORIO DE TERMOFLUIDOS',    '6860': 'LAB. TRANSFERENCA DE CALOR',    '547': 'MAQUINAS DE DESPLAZAMIENTO POSITIVO',    '462': 'MECANICA DE FLUIDOS I',    '536': 'MECANICA DE FLUIDOS II',    '1756': 'MECANICA DE FLUIDOS II',    '3081': 'PLANTAS TERMOELECTRICAS Y SISTEMAS DE COGENERACION',    '2501': 'SISTEMAS DE CONVERSION DE ENERGIA TERMICA',    '2137': 'SISTEMAS DE MEJORAMIENTO AMBIENTAL',    '2926': 'SISTEMAS TERMOENERGETICOS',    '2077': 'TEMAS SELECTOS DE TERMOFLUIDOS I',    '2078': 'TEMAS SELECTOS DE TERMOFLUIDOS II',    '901': 'TERMODINAMICA APLICADA',    '1409': 'TERMOFLUIDOS',    '1860': 'TRANSFERENCIA DE CALOR',    '900': 'TURBOMAQUINARIA',    '1760': 'ADMINISTRACION EN INGENIERIA',    '234': 'EDIFICACION',    '3025': 'INTRODUCCION A LA GERENCIA DE PROYECTOS',    '1608': 'MOVIMIENTO DE TIERRAS',    '3026': 'PREPARACION DE CONCURSO DE OBRA PUBLICA',    '1444': 'PROCEDIMIENTOS CONTRUCTIVOS DE ELEMENTOS ESTRUCT',    '1596': 'PROGRAMACION Y PRESUPUESTACIÓN',    '1407': 'RECURSOS DE LA CONSTRUCCION',    '3028': 'SUPERVISION DE OBRAS',    '3030': 'TEMAS ESPECIALES DE CONSTRUCCION II',    '3058': 'AEROPUERTOS',    '3059': 'CARRETERAS',    '2156': 'EVALUACION DE PROYECTOS',    '3061': 'FERROCARRILES',    '2913': 'INGENIERIA DEL TRANSPORTE I',    '2915': 'INGENIERIA DEL TRANSPORTE II',    '387': 'INGENIERIA DE SISTEMAS I',    '1731': 'INGENIERIA DE SISTEMAS II',    '2803': 'INGENIERIA DE TRANSITO',    '2916': 'INTEGRACION DE PROYECTOS',    '642': 'PLANEACION',    '3062': 'PUERTOS',    '2700': 'TEMAS ESPECIALES DE SISTEMAS I',    '1703': 'ANALISIS ESTRUCTURAL',    '2801': 'DIMENSIONAMIENTO DE  ELEMENTOS  ESTRUCTURALES',    '230': 'DISEÑO ESTRUCTURAL',    '3031': 'ESTRUCTURAS DE ACERO',    '274': 'ESTRUCTURAS DE CONCRETO',    '3032': 'ESTRUCTURAS DE MAMPOSTERIA',    '275': 'ESTRUCTURAS ISOSTATICAS',    '465': 'MECANICA DE MATERIALES I',    '466': 'MECANICA DE MATERIALES II',    '3034': 'PUENTES',    '2936': 'CARTOGRAFIA DIGITAL',    '1334': 'FOTOGRAMETRIA',    '2937': 'GEOMAT APLICA AL ORDEN TERRT',    '1648': 'GESTION AMBIENTAL',    '1534': 'INTRODUCCION A  BASES DE DATOS ESPACIALES',    '1689': 'PERCEPCION REMOTA I',    '1752': 'PERCEPCION REMOTA II',    '1449': 'PROCESOS FOTOGRAMETRICOS',    '1854': 'PROYECTO GEOMATICO',    '1652': 'SISTEMAS DE INFORMACION GEOGRAFICA I',    '1753': 'SISTEMAS DE INFORMACION GEOGRAFICA II',    '2935': 'ASTRONOMIA DE POSCION',    '1548': 'CALCULO DE AJUSTES',    '1750': 'CARTOGRAFIA',    '1599': 'FUNDAMENTOS DE CATASTRO',    '1448': 'GEODESIA I',    '1533': 'GEODESIA II',    '1646': 'GEODESIA III',    '1542': 'GEOLOGIA Y GEOMORFOLOGIA',    '2938': 'GEOMATICA APLICADA AL TRANSP',    '1581': 'HIDRAULICA E HIDROLOGIA',    '2939': 'METODOS GEOFISICOS',    '1543': 'MODELACION MATEMATICA',    '2941': 'PROGRAMACION APLICADA A LA GEOMATICA',    '1647': 'SISTEMAS DE POSICION GLOBAL',    '1637': 'TEORIA DE LOS ERRORES',    '152': 'CIMENTACIONES',    '1601': 'COMPORTAMIENTO DE SUELOS',    '3038': 'DINAMICA DE SUELOS',    '3039': 'ESTRUCTURA DE PAVIMENTOS',    '3040': 'FUNDAMENTOS DE MECANICA DE ROCAS',    '1555': 'FUND. DE MECANICA DEL MEDIO CONTINUO',    '1506': 'GEOLOGIA',    '1714': 'MECANICA DE SUELOS',    '3041': 'MECANICA DE SUELOS APLICADA',    '3042': 'TEMAS ESPECIALES DE GEOTECNIA I',    '2600': 'ESTADISTICA APLICADA A INGENIERIA CIVIL',    '1402': 'HIDRAULICA BASICA',    '1507': 'HIDRAULICA DE CANALES',    '1730': 'HIDRAULICA DE MAQUINAS Y TRANSITORIOS',    '3046': 'HIDRAULICA DE RIOS',    '2061': 'HIDRAULICA URBANA',    '379': 'HIDROLOGIA',    '3047': 'INGENIERIA DE COSTAS',    '3048': 'MODELACIÓN COMPUTACIONAL EN HIDRÁULICA',    '610': 'OBRAS HIDRAULICAS',    '32': 'ABASTECIMIENTO  DE AGUA POTABLE',    '2800': 'ALCANTARILLADO SANITARIO Y PLUVIAL',    '3051': 'EDIFICIOS SUSTENTABLES',    '3052': 'ENERGIA RENOVABLE EN EDIFICIOS',    '1595': 'INGENIERIA AMBIENTAL I',    '2601': 'INGENIERIA AMBIENTAL II',    '3053': 'INGENIERIA DE MANEJO SUSTENTABLE DEL AGUA EN EDIFICIOS',    '3054': 'PLANTAS DE TRATAMIENTO DE AGUA PARA CONSUMO HUMANO',    '3055': 'PROYECTOS SUSTENTABLES DE INGENIERIA',    '1935': 'TRATAMIENTO DE AGUAS RESIDUALES',    '1947': 'ADMINISTRACION DE PROYECTOS',    '1229': 'GEOMATICA BASICA',    '2068': 'HIDROGRAFIA',    '1649': 'LEGISLACION APLIC ING GEOMAT',    '1110': 'PRACTICAS DE TOPOGRAFIA  (2016)',    '1217': 'PRACTICAS DE TOPOGRAFIA II',    '1960': 'PRACTICAS PROFESIONALES',    '1679': 'PROYECTO GEOMETRICO DE OBRAS INFRAESTRUCTURA',    '2942': 'TOPOGRAFIA APLICADA A LA CONSTRUCCION DE EDIFICIOS',    '2070': 'TOPOGRAFIA DE YACIMIENTOS MINERALES',    '1114': 'TOPOGRAFIA I  (2016)',    '1218': 'TOPOGRAFIA II',    '1199': 'ADAPTACION AL CAMBIO CLIMATICO',    '2981': 'ANALISIS DE CICLO DE VIDA',    '2978': 'APROVECH. VALORIZACION DE RESIDUOS',    '2971': 'CAMBIO CLIMATICO',    '2608': 'CONDUCTOS A PRESION Y A SUPERFICIE LIBRE',    '2609': 'CONOCIMIENTO TERRITORIAL',    '2818': 'CONTAMINACION POR RUIDO Y CONTROL',    '2824': 'CONTROL DE CONTAM. SUELOS Y ACUIFEROS',    '2819': 'CONTROL DE EMISIONES A LA ATMOSFERA',    '2970': 'CONTROL DE LA COMBUSTION',    '2972': 'DISEÑO SIST. DESCENTRAL. SUMIN. TRAT. AG',    '1886': 'ECOLOGIA E INGENIERIA',    '2610': 'ECONOMIA AMBIENTAL Y ECOLOGICA',    '2820': 'EVALUACION AMBIENTAL ESTRATEGICA',    '2825': 'EVALUACION DE IMPACTO AMBIENTAL',    '2611': 'EVALUACION DE LA CALIDAD DEL AGUA',    '2710': 'EVALUACION DE LA CALIDAD DEL AIRE',    '2829': 'EVALUACION DE RIESGO AMBIENTAL',    '2821': 'GESTION INTEGRAL DE RESIDUOS DE MANEJO ESPECIAL',    '2711': 'GESTION INTEGRAL DE RESIDUOS SOLIDOS URBANOS',    '2612': 'HIDROLOGIA SUPERFICIAL',    '1887': 'INGENIERIA DE LOS PROCESOS BIOLOGICOS',    '1230': 'INTRODUCCION AL ESTUDIO DEL MEDIO AMBIENTE',    '7611': 'LABORATORIO DE EVALUACION DE LA CALIDAD DEL AGUA',    '7710': 'LABORATORIO DE EVALUACION DE LA CALIDAD DEL AIRE',    '2822': 'MATERIALES Y RESIDUOS PELIGROSOS',    '2502': 'MECANICA DE FLUIDOS PARA ING. AMBIENTAL',    '2975': 'MODELAC. HIDROGEOQUIM. MEDIO ACUOSO',    '2712': 'OPERACIONES Y PROCESOS UNITARIOS',    '2826': 'PROYECT. PLANTAS TRATA. AGUA RESIDUAL',    '2823': 'PROYECT. PLANTAS TRATAM. AGUA. CONS. HUM.',    '1240': 'SEGURIDAD INDUSTRIAL Y PROTECCION AMBIENTAL',    '2827': 'SIST. RECUPER. RECURSOS Y ENERGIA',    '1241': 'TEMAS ESP. MANEJO MATER. RESIDUOS PEL.',    '2505': 'TRANSFERENCIA DE MASA Y ENERGIA',    '2613': 'TRANSPORT.DISPERS.CONTAMIN.ATMOSFER.',    '2713': 'AERODINAMICA',    '1246': 'AEROELASTICIDAD',    '1265': 'ANALIS.DISEÑO DE UNA MISION ESPACIAL',    '2811': 'AVIONICA I',    '1247': 'AVIONICA II',    '1477': 'DERECHO AEREO Y ESPACIAL',    '2812': 'DESARROLLO DE EMPRENDEDORES',    '1266': 'ELEMENTOS DISEÑO SISTEMAS ESPACIALES',    '2828': 'ESTRUCTURAS AEROESPACIALES',    '2830': 'FUNDAMENTOS ANTENAS-SIST.RADIOTRANC',    '1476': 'FUNDAMENTOS DE MECANICA DE VUELO',    '2714': 'FUNDAMENTOS SISTEMS.ELECTRON.ANALOG',    '1248': 'HIDRAULICA INDUSTRIAL',    '2614': 'INGENIERIA TERMICA',    '1144': 'INTRODUCCIÓN A INGENIERIA AEROESPACIAL',    '7714': 'LAB. FUNDAMENTOS SISTEMS.ELECTRON.ANALOG',    '7830': 'LABORATORIO DE FUNDAMENTOS DE ANTENAS Y SISTEMAS DE RADIOTRANCEPTORES (L+)',    '1267': 'LANZADORES',    '1268': 'MECANICA ORBITAL',    '1245': 'MEDIO AMBIENTE AEROESPACIAL',    '2980': 'MODELADO BASADO EN DISEÑO',    '1249': 'PROCESOS DE MANUFACTURA D AERONAVES',    '1250': 'PRUEBAS DE CERTIFICACION AERONAUTICA',    '1269': 'PRUEBAS DE CERTIFICACION ESPACIAL',    '2831': 'SISTEMAS DE PROPULSION',    '2715': 'VIBRACIONES'}

longitudParaCentrar = 100
hora_entrada = 7
hora_salida = 13
# Esta es la columna que representa el cupo en el DataFrame
columna_cupo = 7
# Lista de claves que deseas conservar
claves_a_conservar = [1867,6867,1858,1765,2901,2914,2927,2928,2929,2930,2931,1866,2932,2934,2944,2945,2946,2947,2948.0674,2949,2950,1916,1018,2951,2952,'0757',2954,2955,2956,2957]
# Agregaremos materias ya cursadas para que no se considere en la entrega de horarios
materias_ya_cursadas = [2928,2958,2933]
# def formatoDeImpresion(resultados,nombreMateria,claveMateria):
#     print("#".center(longitudParaCentrar, "#"))
#     print(f"Materia: {nombreMateria} ({claveMateria})".center(longitudParaCentrar, " "))
#     print("#".center(longitudParaCentrar, "#"))
#     if resultados.empty:
#         print("No hay horarios disponibles".center(longitudParaCentrar, " "))
#     else:
#         print(resultados)
#     print("".center(longitudParaCentrar, "_"))
#     print("\n\n\n")

def formatoDeImpresion(resultados, nombreMateria, claveMateria):
    # Códigos ANSI para colores
    RESET = '\033[0m'  # Restablece el color a por defecto
    ROJO = '\033[31m'  # Rojo
    VERDE = '\033[32m'  # Verde
    AZUL = '\033[34m'  # Azul
    AMARILLO = '\033[33m'  # Amarillo

    # Definir longitud para centrar
    longitudParaCentrar = 100  # Puedes ajustar esto según sea necesario

    # Título de la materia
    print(AMARILLO+"".center(longitudParaCentrar, "#"))
    print(f"{VERDE}Materia: {nombreMateria} ({claveMateria})".center(longitudParaCentrar, " "))
    print(AMARILLO+"".center(longitudParaCentrar, "#"))

    # Mensaje si no hay horarios disponibles
    if resultados.empty:
        print(f"{ROJO}No hay horarios disponibles".center(longitudParaCentrar, " "))
    else:
        # Asignaremos un valor al encabezado de cada columna para que se vea más claro
        resultados.columns = ['Grupo', 'Profesor', 'Horario', 'Días', 'Cupo']
        print(f"{AZUL}{resultados}{RESET}")  # Coloca los resultados en azul
    
    # Línea final con un guion bajo
    print(AMARILLO+"".center(longitudParaCentrar, "_"))
    
    # Espacios adicionales
    print("\n\n\n")


# Filtrar los horarios antes de las 13:00
def es_hora_valida_salida(horario):
    # Extraer la hora de fin de la clase (antes del 'a'), ya que queremos que el horario
    # se ajuste a nuestra disponibilidad de tiempo
    hora_inicio = horario.split(' a ')[1]
    # Convertir la hora de inicio a formato de hora
    hora = datetime.strptime(hora_inicio, '%H:%M')
    return hora.hour <= hora_salida   # Filtra si la hora es antes de las 13:00

# Filtrar los horarios antes de las 13:00
def es_hora_valida_entrada(horario):
    # Extraer la hora de fin de la clase (antes del 'a'), ya que queremos que el horario
    # se ajuste a nuestra disponibilidad de tiempo
    hora_inicio = horario.split(' a ')[0]
    # Convertir la hora de inicio a formato de hora
    hora = datetime.strptime(hora_inicio, '%H:%M')

    return hora.hour >= hora_entrada # Filtra si la hora es antes de las 13:00

def filtrarTabla(df):
    # Seleccionar las columnas 1, 2, 4, 5 y columna_cupo
    columnas_seleccionadas = [1, 2, 4, 5, columna_cupo]
    columnas_disponibles = [col for col in columnas_seleccionadas if col < len(df.columns)]
    df_excluyendoColumnas = df.iloc[:, columnas_disponibles]
    
    # Eliminar la cadena "(PRESENCIAL)" de la columna de profesores (columna en posición 1)
    df_excluyendoColumnas.iloc[:, 1] = df_excluyendoColumnas.iloc[:, 1].str.replace(r" \(PRESENCIAL\)", "", regex=True)

    # Excluir los últimos dos renglones
    df_excluyendoRenglones = df_excluyendoColumnas.iloc[:-2, :]
    
    # Asegurar que la columna de interés sea numérica antes de la comparación
    df_excluyendoRenglones.iloc[:, -1] = pd.to_numeric(df_excluyendoRenglones.iloc[:, -1], errors='coerce')
    
    # Filtrar filas donde la columna 8 tenga valores mayores a 0
    df_filtrado = df_excluyendoRenglones[df_excluyendoRenglones.iloc[:, -1] > 0]

    # Aplicar el filtro a la columna de horarios para que sea antes de un horario específico
    df_filtrado = df_filtrado[df_filtrado.iloc[:, 2].apply(es_hora_valida_salida)]  # Asumiendo que la columna de horario está en la posición 2

    # Aplicar el filtro a la columna de horarios para que sea despues de un horario específico
    df_filtrado = df_filtrado[df_filtrado.iloc[:, 2].apply(es_hora_valida_entrada)]  # Asumiendo que la columna de horario está en la posición 2

    # Eliminar la cadena "(PRESENCIAL)" en la columna de profesores
    

    return df_filtrado

def imprimirMaterias(materiasPorMeter):
    resultados_por_materia = {}

    for materia in materiasPorMeter:
        # Obtener el valor correspondiente a la clave 'materia'
        nombreMateria = materiasPorMeter[materia]
        
        # Leer el contenido de la URL
        url = f"https://www.ssa.ingenieria.unam.mx/cj/tmp/programacion_horarios/{materia}.html"
        try:
            response = requests.get(url)
            detected_encoding = detect(response.content)['encoding']  # Detectar la codificación
            response.encoding = detected_encoding  # Aplicar la codificación detectada
            
            # Envolver el texto en un objeto StringIO antes de pasarlo a read_html
            html_content = StringIO(response.text)
            dfs = pd.read_html(html_content)  # Leer el HTML como texto literal desde StringIO
            df = dfs[0]  # Seleccionar la primera tabla
        except Exception as e:
            print(f"Error al leer la URL para la materia {materia}: {e}")
            continue
        
        # Filtrar el DataFrame para entregar solo las columnas deseadas
        #df_excluyendoRenglones = filtrarTabla(df)
        # Imprimir el nombre de la materia y el DataFrame seleccionado
        
        #formatoDeImpresion(df_excluyendoRenglones, nombreMateria, materia)
        df_filtrado = filtrarTabla(df)
        resultados_por_materia[materia] = (nombreMateria, df_filtrado)

    mostrar_resultados_combinados(resultados_por_materia)

#Funcion para mostrar los resultados en una ventana y no por consola
def mostrar_resultados_combinados(resultados_por_materia):
    ventana = tk.Tk()
    ventana.title("Resultados Horarios")

    frame = ttk.Frame(ventana)
    frame.pack(fill=tk.BOTH, expand=True)

    #Nombres de los encabezados a mostar 
    tree = ttk.Treeview(frame, columns=("Clave", "Nombre", "Grupo", "Profesor", "Horario", "Días", "Cupo"), show="headings")
    tree.heading("Clave", text="Clave")
    tree.heading("Nombre", text="Nombre")
    tree.heading("Grupo", text="Grupo")
    tree.heading("Profesor", text="Profesor")
    tree.heading("Horario", text="Horario")
    tree.heading("Días", text="Días")
    tree.heading("Cupo", text="Cupo")

    #Anchos de los encabezados y ubicacion de los mismos  
    tree.column("Clave", width=50, anchor="center")
    tree.column("Nombre", width=230, anchor="w")  
    tree.column("Grupo", width=40, anchor="center")
    tree.column("Profesor", width=150, anchor="w")
    tree.column("Horario", width=100, anchor="center")
    tree.column("Días", width=80, anchor="center")
    tree.column("Cupo", width=50, anchor="center")

    #Hace responsiva la ventana
    scrollbar_y = ttk.Scrollbar(frame, orient=tk.VERTICAL, command=tree.yview)
    tree.configure(yscroll=scrollbar_y.set)
    scrollbar_y.pack(side=tk.RIGHT, fill=tk.Y)

    tree.pack(fill=tk.BOTH, expand=True, padx=10, pady=10)

    for claveMateria, (nombreMateria, resultados) in resultados_por_materia.items():
        if not resultados.empty:
            for _, row in resultados.iterrows():
                tree.insert("", "end", values=(claveMateria, nombreMateria, *row.tolist()))
            # Línea en blanco entre claves para tener una mejor visualizacion 
            tree.insert("", "end", values=("", "", "", "", "", "", ""))  

    #Boton para cerrar la ventana 
    tk.Button(ventana, text="Cerrar", command=ventana.destroy).pack(pady=10)
    ventana.mainloop()

# retiraremos las materias ya cursadas
claves_a_conservar = [clave for clave in claves_a_conservar if clave not in materias_ya_cursadas]
# La lista de enteros, la pasamos a una lista de strings
claves_a_conservar = list(map(str, claves_a_conservar))

# Filtra el diccionario
misMaterias_filtrado = {clave: misMaterias[clave] for clave in claves_a_conservar if clave in misMaterias}

imprimirMaterias(misMaterias_filtrado)
#Establecemos los horarios disponibles durante la semana
